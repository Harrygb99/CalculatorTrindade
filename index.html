<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Calculadora de Vendas - TRINDADE</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    body {
      /* Cor predominante vermelho/preto - Estilo Fac√ß√£o */
      background: linear-gradient(135deg, #101010, #350000);
      color: #f8f8f2;
      font-family: 'Roboto', sans-serif;
      padding: 20px;
      display: flex;
      justify-content: center;
      flex-direction: column;
      align-items: center;
    }
    .container {
      background: #1e1e1e;
      padding: 40px;
      border-radius: 15px;
      max-width: 900px; /* Estendido */
      width: 95%;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.8);
    }
    .logo-header {
        text-align: center;
        margin-bottom: 20px;
    }
    .logo-header img {
        width: 120px;
        height: auto;
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(255, 0, 0, 0.7);
    }
    h1 {
      text-align: center;
      color: #ff5555;
      font-size: 2.8em;
      margin-top: 10px;
      margin-bottom: 30px;
      text-shadow: 0 0 8px #000;
      letter-spacing: 2px;
    }
    h2 {
      margin-top: 20px;
      color: #ffb86c;
      border-bottom: 1px solid #444;
      padding-bottom: 8px;
    }
    table {
      width: 100%;
      margin-top: 15px;
      border-collapse: collapse;
    }
    th, td {
      padding: 12px;
      font-size: 1.1em;
      border-bottom: 1px solid #333;
      text-align: left;
    }
    /* ESTILO PARA AS IMAGENS NA TABELA */
    .item-cell {
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .item-cell img {
        width: 40px; /* Tamanho do Pendrive */
        height: auto;
        vertical-align: middle;
        border-radius: 3px;
    }
    input[type="number"] {
      width: 100%; 
      min-width: 80px;
      padding: 6px;
      font-size: 1em;
      background: #282a36;
      color: #fff;
      border: 1px solid #ff5555;
      border-radius: 8px;
      box-sizing: border-box;
    }
    /* Estilo para inputs de Vendedor/Comprador */
    .input-group label {
        display: block; 
        color: #ff5555; 
        margin-bottom: 5px; 
        font-weight: bold;
    }
    .input-group input[type="text"] {
        width: 100%; 
        padding: 8px; 
        font-size: 1em; 
        background: #282a36; 
        color: #fff; 
        border: 1px solid #ff5555; 
        border-radius: 8px; 
        box-sizing: border-box;
    }

    .parceria-options {
        margin-bottom: 30px;
        padding: 15px;
        background: #282a36;
        border: 1px solid #ff5555;
        border-radius: 10px;
        text-align: center;
    }
    .parceria-options label {
        margin-right: 20px;
        font-size: 1.2em;
        color: #f1fa8c;
    }
    .button-group {
      text-align: center;
      margin-top: 30px;
      margin-bottom: 10px;
    }
    button {
      padding: 14px 28px;
      margin: 10px;
      border: none;
      border-radius: 10px;
      font-size: 1.1em;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .calculate {
      background: linear-gradient(to right, #ff5555, #cc0000);
      color: #fff;
    }
    .calculate:hover {
      background: linear-gradient(to right, #ff6e6e, #e60000);
    }
    .reset {
      background-color: #6272a4;
      color: white;
    }
    .reset:hover {
      background-color: #7a8aa3;
    }
    .download-btn {
        background: #50fa7b; 
        color: #0d0d0d;
    }
    .download-btn:hover {
        background: #69ff94;
    }
    .result {
      background: #0d0d0d;
      padding: 25px;
      margin-top: 20px;
      border-radius: 10px;
      font-size: 1.8em;
      border: 3px solid #ff5555;
      text-align: center;
      color: #50fa7b;
    }
    /* Estilo para a √°rea de comprovante (opcional, para visualiza√ß√£o antes do download) */
    #comprovante-area {
        padding: 20px; 
        background: #1e1e1e; 
        border: 3px solid #ffb86c; 
        border-radius: 10px; 
        margin-top: 20px; 
        color: #f8f8f2;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="logo-header">
        <img src="Trindade22.png" alt="Logo da Trindade">
    </div>
    <h1>‚ô¶Ô∏è TRINDADE ‚Äî TABELA DE PRE√áOS ‚ô¶Ô∏è</h1>

    <form id="calcForm">
        
      <div class="input-group" style="margin-bottom: 25px; display: flex; gap: 20px;">
          <div style="flex-grow: 1;">
              <label for="vendedor">üë§ Vendedor:</label>
              <input type="text" id="vendedor" name="vendedor" placeholder="Seu Nome RP">
          </div>
          <div style="flex-grow: 1;">
              <label for="comprador">üè¥ Fac√ß√£o Compradora:</label>
              <input type="text" id="comprador" name="comprador" placeholder="Nome da Fac√ß√£o">
          </div>
      </div>
      <div class="parceria-options">
          <label><input type="radio" name="parceria" value="sem" checked> Sem Parceria</label>
          <label><input type="radio" name="parceria" value="com"> Com Parceria</label>
      </div>

      <h2>üíæ Vendas</h2>
      <table>
        <tr><th>Item</th><th>Pre√ßo (C/S Parceria)</th><th>Qtd</th></tr>
        
        <tr>
            <td>
                <div class="item-cell">
                    <img src="fajuto.png" alt="Pendrive Fajuto (Azul)"> PENDRIVE FAJUTO
                </div>
            </td>
            <td>R$ 2.500 / R$ 3.000</td>
            <td><input type="number" name="FAJUTO" min="0" value="0"></td>
        </tr>
        <tr>
            <td>
                <div class="item-cell">
                    <img src="comum.png" alt="Pendrive Comum (Branco)"> PENDRIVE COMUM
                </div>
            </td>
            <td>R$ 3.500 / R$ 4.000</td>
            <td><input type="number" name="COMUM" min="0" value="0"></td>
        </tr>
        <tr>
            <td>
                <div class="item-cell">
                    <img src="incomum.png" alt="Pendrive Incomum (Verde)"> PENDRIVE INCOMUM
                </div>
            </td>
            <td>R$ 5.500 / R$ 6.000</td>
            <td><input type="number" name="INCOMUM" min="0" value="0"></td>
        </tr>
        <tr>
            <td>
                <div class="item-cell">
                    <img src="raro.png" alt="Pendrive Raro (Vermelho)"> PENDRIVE RARO
                </div>
            </td>
            <td>R$ 12.000 / R$ 13.000</td>
            <td><input type="number" name="RARO" min="0" value="0"></td>
        </tr>
        <tr>
            <td>
                <div class="item-cell">
                    <img src="especial.png" alt="Pendrive Especial (Preto)"> PENDRIVE ESPECIAL
                </div>
            </td>
            <td>R$ 25.000 / R$ 26.000</td>
            <td><input type="number" name="ESPECIAL" min="0" value="0"></td>
        </tr>
        <tr>
            <td>
                <div class="item-cell">
                    üß§ LUVA
                </div>
            </td>
            <td>R$ 1.000 / R$ 1.300</td>
            <td><input type="number" name="LUVA" min="0" value="0"></td>
        </tr>
      </table>

      <div class="button-group">
        <button type="button" class="calculate" onclick="calcular()">Calcular e Gerar Comprovante</button>
        <button type="button" class="reset" onclick="resetar()">Zerar</button>
      </div>
    </form>

    <div id="resultado" class="result"></div>

    <div id="comprovante-area" style="display: none;">
        </div>
    
    <div class="button-group">
        <button type="button" id="download-btn" class="download-btn" onclick="baixarComprovante()" style="display: none;">‚¨áÔ∏è Baixar Imagem (JPEG)</button>
    </div>

  </div>

  <script>
    // Defini√ß√£o dos pre√ßos com e sem parceria (Adicionado o nome completo para o comprovante)
    const precosVariaveis = {
        FAJUTO: { com: 2500, sem: 3000, nome: "PENDRIVE FAJUTO" },
        COMUM: { com: 3500, sem: 4000, nome: "PENDRIVE COMUM" },
        INCOMUM: { com: 5500, sem: 6000, nome: "PENDRIVE INCOMUM" },
        RARO: { com: 12000, sem: 13000, nome: "PENDRIVE RARO" },
        ESPECIAL: { com: 25000, sem: 26000, nome: "PENDRIVE ESPECIAL" },
        LUVA: { com: 1000, sem: 1300, nome: "LUVA" }
    };

    function formatCurrency(value) {
      // Formata como moeda brasileira com 2 casas decimais.
      return value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL', minimumFractionDigits: 2 });
    }

    function calcular() {
      const form = document.forms["calcForm"];
      let total = 0;
      let itensVendidos = [];

      // Dados do Vendedor e Comprador
      const vendedor = document.getElementById("vendedor").value.toUpperCase() || "N√ÉO INFORMADO";
      const comprador = document.getElementById("comprador").value.toUpperCase() || "N√ÉO INFORMADO";
      
      // Determina se a parceria est√° ativa
      const isParceria = form.parceria.value === 'com';
      const tipoPreco = isParceria ? 'com' : 'sem';
      const statusParceria = isParceria ? 'COM PARCERIA' : 'SEM PARCERIA';

      // Calcula o total e registra itens
      for (const item in precosVariaveis) {
        const input = form[item];
        const qtd = parseInt(input ? input.value : '0') || 0;
        const preco = precosVariaveis[item][tipoPreco];
        
        if (qtd > 0) {
            total += preco * qtd;
            itensVendidos.push(`<li>${qtd}x ${precosVariaveis[item].nome} (${formatCurrency(preco)} un.)</li>`);
        }
      }

      // 1. Atualiza o resultado total
      document.getElementById("resultado").innerHTML = `<strong>TOTAL A RECEBER: ${formatCurrency(total)}</strong>`;
      
      // 2. Monta o HTML do Comprovante com estilo para ser capturado
      const comprovanteHTML = `
        <div id="comprovante-content" style="font-family: 'Roboto', sans-serif; padding: 25px; background: #0d0d0d; border-radius: 8px; color: #f8f8f2; border: 3px solid #ffb86c; width: 450px; margin: 0 auto;">
            <h3 style="color: #ff5555; text-align: center; border-bottom: 2px solid #ff5555; padding-bottom: 10px; margin-top: 0; font-size: 1.5em;">COMPROVANTE DE VENDA - TRINDADE ‚ô¶Ô∏è</h3>
            <p style="font-size: 1.1em; margin-bottom: 5px;"><strong>üë§ Vendedor:</strong> ${vendedor}</p>
            <p style="font-size: 1.1em; margin-bottom: 15px;"><strong>üè¥ Comprador:</strong> ${comprador}</p>
            <p style="font-size: 1.1em; margin-bottom: 15px; color: #f1fa8c;"><strong>ü§ù Status:</strong> ${statusParceria}</p>
            <h4 style="color: #ffb86c; border-bottom: 1px solid #444; padding-bottom: 5px; font-size: 1.2em;">Itens Vendidos:</h4>
            <ul style="list-style-type: disc; padding-left: 20px; margin-top: 5px; font-size: 1.1em;">
                ${itensVendidos.length > 0 ? itensVendidos.join('') : '<li>Nenhum item vendido.</li>'}
            </ul>
            <h2 style="color: #50fa7b; text-align: center; padding: 15px; background: #1e1e1e; border-radius: 5px; margin-top: 25px; border: 1px solid #50fa7b; font-size: 2em;">VALOR TOTAL: ${formatCurrency(total)}</h2>
            <p style="text-align: center; font-size: 0.9em; margin-top: 15px; color: #6272a4;">Gerado em: ${new Date().toLocaleString('pt-BR')}</p>
        </div>
      `;

      const comprovanteArea = document.getElementById("comprovante-area");
      comprovanteArea.innerHTML = comprovanteHTML;
      comprovanteArea.style.display = 'block';
      document.getElementById("download-btn").style.display = 'inline-block';
      
      // Move a visualiza√ß√£o do comprovante para o topo da √°rea de resultado para melhor UX
      comprovanteArea.scrollIntoView({ behavior: 'smooth' });
    }

    // NOVA FUN√á√ÉO PARA BAIXAR O COMPROVANTE
    function baixarComprovante() {
        const comprovanteDiv = document.getElementById("comprovante-content"); // Captura APENAS o conte√∫do do comprovante

        if (!comprovanteDiv) {
            alert('Calcule a venda primeiro para gerar o comprovante.');
            return;
        }

        // Usa html2canvas para converter o div em canvas
        html2canvas(comprovanteDiv, { 
            scale: 2, // Aumenta a resolu√ß√£o para uma imagem mais n√≠tida
            backgroundColor: '#1e1e1e', // Cor de fundo para o comprovante
            useCORS: true 
        }).then(canvas => {
            // Converte o canvas para Data URL (imagem) no formato JPEG (qualidade 0.9)
            const imageURL = canvas.toDataURL('image/jpeg', 0.9); 
            
            // Cria um link tempor√°rio para download
            const link = document.createElement('a');
            link.href = imageURL;
            link.download = `comprovante_trindade_${Date.now()}.jpeg`; 
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }).catch(error => {
            console.error('Erro ao gerar a imagem:', error);
            alert('N√£o foi poss√≠vel gerar a imagem do comprovante. Verifique o console para detalhes.');
        });
    }

    function resetar() {
      const form = document.forms["calcForm"];
      
      // Reseta inputs de quantidade
      for (const input of form.querySelectorAll('input[type="number"]')) input.value = 0;

      // Reseta campos de texto
      document.getElementById("vendedor").value = '';
      document.getElementById("comprador").value = '';

      // Reseta o seletor de Parceria para "Sem Parceria"
      if (form.parceria) form.parceria.value = 'sem';
      
      document.getElementById("resultado").innerHTML = "";
      document.getElementById("comprovante-area").innerHTML = "";
      document.getElementById("comprovante-area").style.display = 'none';
      document.getElementById("download-btn").style.display = 'none';
    }
  </script>
</body>
</html>
